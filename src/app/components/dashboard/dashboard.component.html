<div class="container-fluid">
  <div class="row mb-4">
    <div class="col-md-2 w-100">
      <button
      type="button"
      class="btn btn-primary "
      data-toggle="modal"
      data-target="#operationAddModel"
    >
      Coin Ekle
    </button>
    </div>
    <div class="col-md-10">
      <input
      type="text"
      [(ngModel)]="filterText"
      class="form-control bg-dark rounded"
      id="searchRecentOperation"
      placeholder="Aramak istediğiniz coin"
    />
    </div>
  </div>
  <table class="table">
    <thead>
      <tr>
        <th class="text-center">Sembol</th>
        <th class="text-center">Adet</th>
        <th class="text-center">Alış</th>
        <th class="text-center">Anlık</th>
        <th class="text-center">Kâr/Zarar</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr
        *ngFor="
          let operation of recentOperations | recentOperationFilter: filterText
        "
      >
        <td class="text-center">
          <div class="badge bg-success">
            <h6>{{ operation.coinsymbol }}</h6>
          </div>
        </td>
        <td class="text-center">{{ operation.coinamount }}</td>
        <td class="text-center">
          <strong>Birim Maliyet:</strong>
          <span style="float: right">{{ operation.buycost }}</span>
          <br />
          <strong>Toplam Maliyet:</strong>
          <span style="float: right">{{
            totalCostCalculate(operation.buycost, operation.coinamount)
          }}</span>
        </td>
        <td class="text-center">
          <strong>Birim Değer:</strong>
          <span style="float: right">{{binanceService.prices.get(operation.coinsymbol.toLowerCase())}}</span>
          <br />
          <strong>Toplam Değer:</strong>
          <span style="float: right">{{
            totalValueCalculate(binanceService.prices.get(operation.coinsymbol.toLowerCase()), operation.coinamount)
          }}</span>
        </td>
        <td class="text-center">
          <span
            >${{
              pnlCalculate(operation.coinamount, operation.buycost, binanceService.prices.get(operation.coinsymbol.toLowerCase()))
            }}</span
          >
          <br />
          <span>%{{ pnlCalculatePercent(operation.buycost, binanceService.prices.get(operation.coinsymbol.toLowerCase())) }}</span>
        </td>
        <td class="text-center">
          <div class="dropdown">
            <button
              class="btn btn-info dropdown-toggle"
              type="button"
              id="dropdownMenuButton"
              data-toggle="dropdown"
              aria-haspopup="true"
              aria-expanded="false"
            >
              İşlemler
            </button>
            <div
              class="dropdown-menu bg-dark"
              aria-labelledby="dropdownMenuButton"
            >
              <button
                type="button"
                class="btn bg-dark dropdown-item"
                data-toggle="modal"
                data-target="#sellCoin"
                (click)="setSelectedModal(operation)"
              >
                Sat
              </button>

              <button
                class="dropdown-item btn bg-dark"
                (click)="deleteRecentOperation(operation)"
                >Sil</button
              >
              <button class="dropdown-item btn bg-dark">Güncelle</button>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- MODALS -->
<div class="modal fade" tabindex="-1" role="dialog" id="operationAddModel">
  <div class="modal-dialog modal-dialog-scrollable" role="document">
    <div class="modal-content bg-dark">
      <div class="modal-header">
        <h4 class="modal-title">Add Item</h4>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body container my-4">
        <h2 class="h3 mb-3 font-weight-normal">Hangi Coini Aldığını Seçiniz</h2>
        <ng-multiselect-dropdown
          [placeholder]="'Coin Seçin'"
          [settings]="dropdownSettings"
          [data]="coinPairs"
          [(ngModel)]="coinsymbol"
          (onSelect)="setCoinSymbol($event)"
          class=" text-black"
        >
        </ng-multiselect-dropdown>
        <br />
        <h1 class="h3 mb-3 font-weight-normal">Adet</h1>
        <form [formGroup]="addCoinForm">
          <div class="form-floating">
            <input
              formControlName="coinamount"
              type="number"
              class="form-control bg-dark"
              id="floatingInput"
              placeholder="Kaç adet aldığınızı giriniz."
            />
          </div>
          <br />
          <h1 class="h3 mb-3 font-weight-normal">Alış Fiyatı</h1>
          <div class="form-floating">
            <input
              formControlName="buycost"
              type="number"
              class="form-control bg-dark"
              id="floatingPassword"
              placeholder="Hangi fiyattan aldığınızı seçiniz."
            />
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">
          Kapat
        </button>
        <button
          type="button"
          class="btn btn-primary"
          data-dismiss="modal"
          (click)="addRecentOperation()"
        >
          Değişiklikleri Kaydet
        </button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" tabindex="-1" role="dialog" id="sellCoin">
  <div class="modal-dialog">
    <div class="modal-content bg-dark">
      <div class="modal-header">
        <h4 class="modal-title">Satış Yap</h4>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body container my-4">
        <div class="jumbotron bg-success">
          <p>Satacağınız Coin: {{ selectedModal.coinsymbol }}</p>
          <p>Elinizdeki Miktar: {{ selectedModal.coinamount }}</p>
          <p>Alış Fiyatı: {{ selectedModal.buycost }}</p>
          <p>Anlık Fiyat: 8.13</p>
        </div>

        <form [formGroup]="addArchivedOperationForm">
          <div class="form-group">
            <input
              formControlName="coinamount"
              type="number"
              class="form-control bg-dark"
              id="floatingInput2"
              placeholder="Satış Adedi:"
            />
          </div>
          <br />
          <div class="form-group">
            <input
              formControlName="sellcost"
              type="number"
              class="form-control bg-dark"
              id="floatingInput3"
              placeholder="Satış Fiyatı:"
            />
          </div>
        </form>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">
          Kapat
        </button>
        <button
          type="button"
          class="btn btn-primary"
          data-dismiss="modal"
          (click)="addArchivedOperation()"
        >
          Satıldı olarak işaretle
        </button>
      </div>
    </div>
  </div>
</div>